class MouseHandler{constructor(a,b,c){this.controller=a,this.graphics=b,this.slider=c,this.isDraggingScreen,this.isZooming=!1,this.dragX=null,this.dragY=null,this.initListeners()}initListeners(){document.addEventListener("mousedown",this.mousedown.bind(this)),document.addEventListener("touchstart",this.mousedown.bind(this)),document.addEventListener("mousemove",this.mousemove.bind(this)),document.addEventListener("touchmove",this.mousemove.bind(this)),document.addEventListener("mouseup",this.mouseup.bind(this)),document.addEventListener("touchend",this.mouseup.bind(this));const a=document.getElementById("enter");a.addEventListener("click",this.enterGame.bind(this)),document.addEventListener("keyup",this.enterGameKey.bind(this));const b=document.getElementById("join");b.addEventListener("click",this.joinGame.bind(this)),this.slider.addEventListener("mousedown",this.zoomStart.bind(this)),this.slider.addEventListener("touchstart",this.zoomStart.bind(this)),this.slider.addEventListener("mousemove",this.zoom.bind(this)),this.slider.addEventListener("touchmove",this.zoom.bind(this)),this.slider.addEventListener("mouseup",this.zoomEnd.bind(this)),this.slider.addEventListener("touchend",this.zoomEnd.bind(this))}mousedown(a){if(!this.controller.hasName())return;a.touches&&(a=a.touches[0]),this.dragX=a.clientX,this.dragY=a.clientY;let b=null;if(this.controller.isTurn()){const c=this.controller.getCards();for(let d=c.length-1;0<=d;d--){const e=this.graphics.convertRealToVirtualX(a.clientX),f=this.graphics.convertRealToVirtualY(a.clientY);if(c[d].intersects(e,f)){b=c[d];break}}}return null==b?this.isDraggingScreen=!0:this.controller.grabCard(b),!1}mousemove(a){if(!this.controller.hasName())return;if(a.touches&&(a=a.touches[0]),null==this.dragX||null==this.dragY)return;const b=a.clientX-this.dragX,c=a.clientY-this.dragY;if(this.dragX=a.clientX,this.dragY=a.clientY,this.controller.isCardGrabbed()){const a=this.graphics.convertToVirtualScale(b),d=this.graphics.convertToVirtualScale(c);this.controller.moveCard(a,d)}else this.isDraggingScreen&&this.graphics.dragScreen(b,c)}mouseup(){this.controller.hasName()&&(this.controller.releaseCard(),this.dragX=null,this.dragY=null,this.isDraggingScreen=!1)}enterGame(a,b){b||(b=!1);const c=document.getElementById("name").value,d=document.getElementById("code").value;this.controller.submitName(c,d,b)}enterGameKey(a){13!==a.keyCode||this.enterGame(a,!1)}joinGame(a){a.stopPropagation(),this.enterGame(a,!0)}zoomStart(a){a.stopPropagation(),this.isZooming=!0}zoom(a){this.isZooming&&(a.stopPropagation(),this.controller.setZoom(a.toElement.value))}zoomEnd(){this.isZooming=!1}}"undefined"!=typeof module&&(module.exports=MouseHandler);