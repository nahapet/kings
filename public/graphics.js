class Graphics{constructor(a,b,c){this.controller=a,this.canvas=b,this.ctx=c,this.dragX=0,this.dragY=0,this.scale=null,this.cardBackImage=null,this.tableImage=null,this.cardFaceImages={},this.loadImages(),this.drawLoop(),window.addEventListener("resize",this.onResize.bind(this))}loadImages(){this.cardBackImage=new Image,this.cardBackImage.src="images/back.png",this.tableImage=new Image,this.tableImage.src="images/stone.jpg",this.logoImage=new Image,this.logoImage.src="images/logo.png",Card.RANKS.forEach(a=>{this.cardFaceImages[a]={},Card.SUITES.forEach(b=>{const c=new Image;this.cardFaceImages[a][b]=c,c.src=`images/cards/${a}${b}.png`})})}drawLoop(){this.clearAndResize(),this.drawCards(),setTimeout(this.drawLoop.bind(this),100)}onResize(){null==this.scale&&(this.scale=1);const a=window.innerWidth,b=window.innerHeight,c=5*(this.scale*Card.HEIGHT);if(c>a||c>b){const d=Math.min(a/c,b/c);this.scale=d*this.scale,this.controller.updateSlider(this.scale)}}clearAndResize(){const a=this.ctx,b=window.innerWidth,c=window.innerHeight;null==this.scale&&this.onResize(),this.canvas.width=b,this.canvas.height=c,a.setTransform(1,0,0,1,0,0),this.drawBackground(b,c),this.translateX=b/2,this.translateY=c/2,a.translate(this.translateX,this.translateY),a.translate(this.dragX,this.dragY),a.scale(this.scale,this.scale);a.drawImage(this.logoImage,-210,-210,420,420)}drawBackground(a,b){const c=this.ctx,d=c.createPattern(this.tableImage,"repeat");if(null!=d){const c=new DOMMatrix,e=c.translateSelf(this.dragX+a/2,this.dragY+b/2,0).scaleSelf(2*this.scale,2*this.scale,1);d.setTransform(e)}c.fillStyle=d,c.fillRect(0,0,a,b)}drawCards(){const a=this.controller.getCards();for(const b in a)a[b].draw(this.ctx,this.cardBackImage,this.cardFaceImages)}convertRealToVirtualX(a){return(a-this.translateX-this.dragX)/this.scale}convertRealToVirtualY(a){return(a-this.translateY-this.dragY)/this.scale}convertToVirtualScale(a){return a/this.scale}dragScreen(a,b){this.dragX+=a,this.dragY+=b}setUserScale(a){this.scale=a}}"undefined"!=typeof module&&(module.exports=Graphics);